<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="default">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#86E3CE">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/en/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/en/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/en/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />



  <link rel="icon" type="image/png" sizes="32x32" href="/en/images/logo.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/en/images/logo.ico?v=5.1.4">


  <link rel="mask-icon" href="/en/images/logo.ico?v=5.1.4" color="#86E3CE">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Journal[1] Zhijie Huang, Jun Sun, Xiaopeng Guo and Mingyu Shang. One-for-all: An Efficient Variable Convolution Neural Network for In-loop Filter of VVC[J]. IEEE Trans. Circuits and Systems for Video">
<meta property="og:type" content="website">
<meta property="og:title" content="Papers">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;publication&#x2F;index.html">
<meta property="og:site_name" content="深度视频研究室">
<meta property="og:description" content="Journal[1] Zhijie Huang, Jun Sun, Xiaopeng Guo and Mingyu Shang. One-for-all: An Efficient Variable Convolution Neural Network for In-loop Filter of VVC[J]. IEEE Trans. Circuits and Systems for Video">
<meta property="article:published_time" content="2021-07-25T12:27:27.611Z">
<meta property="article:modified_time" content="2021-07-25T10:02:17.605Z">
<meta property="article:author" content="Sanji">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/en/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"remove","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/publication/"/>





  <title>Papers | 深度视频研究室</title>
  








<meta name="generator" content="Hexo 4.1.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">

  <div class="site-meta custom-logo">
    <table><tr>
      <td colspan="3">
        
          <div class="site-meta-headline">
            <a href="/en/">
              <img class="custom-logo-image" src="/en/images/logo.png"
                  alt="深度视频研究室"/>
            </a>
          </div>
        
      </td>
      <td colspan="2" style="text-align: right;">
        <a target="_blank" href="http://pku.edu.cn">Peking University</a><br><br>
        <a target="_blank" href="http://www.wict.pku.edu.cn">Wangxuan Institute</a>
      </td>
      <td style="text-align: right;">
        <a href="http://pku.edu.cn" target="_blank" rel="noopener">
          <img width = "60%" src="/en/images/pkulogo.png"/>
        </a>
      </td>
    </tr></table>
    <div>
    </div>
    <div class="custom-logo-site-title">
      <a href="/en/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title"></span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/en/" rel="section">
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/en/about/" rel="section">
            
            People
          </a>
        </li>
      
        
        <li class="menu-item menu-item-publication">
          <a href="/en/publication/" rel="section">
            
            Publication
          </a>
        </li>
      
        
        <li class="menu-item menu-item-patent">
          <a href="/en/patent/" rel="section">
            
            Patent
          </a>
        </li>
      
        
        <li class="menu-item menu-item-download">
          <a href="/en/download/" rel="section">
            
            Download
          </a>
        </li>
      
        
        <li class="menu-item menu-item-activities">
          <a href="/en/activities/" rel="section">
            
            Activities
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
  <div class="site-search">
      <a target="_blank" href="../">中文</a>
  </div>
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">

	<h2 class="post-title" itemprop="name headline">Papers</h2>



</header>

      
      
      
      <div class="post-body">
        
        
          <h2 id="Journal"><a href="#Journal" class="headerlink" title="Journal"></a>Journal</h2><p>[1] Zhijie Huang, Jun Sun, Xiaopeng Guo and Mingyu Shang. One-for-all: An Efficient Variable Convolution Neural Network for In-loop Filter of VVC[J]. IEEE Trans. Circuits and Systems for Video Technology (TCSVT), 2021.<br>[2] Zhijie Huang, Jun Sun, Xiaopeng Guo and Mingyu Shang. Adaptive Deep Reinforcement Learning-Based In-Loop Filter for VVC[J]. IEEE Transactions on Image Processing (TIP), 2021.<br>[3] Shengbin Meng, Jun Sun, Yizhou Duan, and Zongming Guo. Adaptive Video Streaming With Optimized Bitstream Extraction and PID-Based Quality Control[J]. IEEE Transactions on Multimedia, 2016.<br>[4] Keji Chen, Jun Sun, Yizhou Duan, and Zongming Guo, “A Novel Wavefront-Based High Parallel Solution for HEVC Encoding”, Accepted by IEEE Trans. Circuits and Systems for Video Technology (TCSVT), 2015.<br>[5] Yizhou Duan, Jun Sun, Leju Yan, Keji Chen, and Zongming Guo, “Novel Efficient HEVC Decoding Solution on General-purpose Processors”, IEEE Trans. Multimedia (TMM), vol. 16, no. 7, pp. 1915 – 1928, November, 2014.<br>[6] Jun Sun, Yizhou Duan, Jiangtao Li, Jiaying Liu and Zongming Guo, “Rate-distortion analysis of dead-zone plus uniform threshold scalar quantization and its application–part I: fundamental theory,” IEEE Trans. Image Process., 2013.<br>[7] Jun Sun, Yizhou Duan, Jiangtao Li, Jiaying Liu and Zongming Guo, “Rate-distortion analysis of dead-zone plus uniform threshold scalar quantization and its application–part II: two-pass VBR coding for H.264/AVC,” IEEE Trans. Image Process., 2013.<br>[8] Xin Zhao, Jun Sun, Siwei Ma and Wen Gao, “Novel statistical modeling, analysis and implementation of rate-distortion estimation for H.264/AVC coders,” IEEE Trans. Circuits Syst. Video Technol., vol. 20, no. 5, pp. 647-660, May. 2010.<br>[9] Jun Sun, Wen Gao, Debin Zhao, Weiping Li, “On Rate-Distortion Modeling and Extraction of H.264/SVC Fine-Granular Scalable Video,” IEEE Trans. Circuits Syst. Video Technol., pp.1-14, Accepted in Jun. 2008.<br>[10] Jun Sun, Wen Gao, Debin Zhao, Qingming Huang, “Statistical Model, Analysis and Approximation of Rate-Distortion Function in MPEG-4 FGS Videos,” IEEE Trans. Circuits Syst. Video Technol., Vol. 16, No. 4, pp. 535-539, Apr. 2006.</p>
<h2 id="Conference"><a href="#Conference" class="headerlink" title="Conference"></a>Conference</h2><h3 id="2021"><a href="#2021" class="headerlink" title="2021"></a>2021</h3><p>[1] Xiaopeng Guo, et al. Enhancing knowledge tracing via adversarial training. ACM Multimedia. (Accepted)</p>
<h3 id="2015-2020"><a href="#2015-2020" class="headerlink" title="2015~2020"></a>2015~2020</h3><p>[1] Zhijie Huang, Xiaopeng Guo, Mingyu Shang, Jie Gao, Jun Sun. An Efficient QP Variable Convolutional Neural Network Based In-loop Filter for Intra Coding. Data Compression Conference. IEEE, 2020.<br>[2] Y. Li, Z. Huang, J. Sun. An Efficient Encoding Method for Video Compositing in HEVC. 26th International Conference on Multimedia Modeling (MMM2020). Oral<br>[3] Z. Huang, Y. Li, J. Sun. Efficient HEVC Downscale Transcoding Based on Coding Unit Information Mapping. 26th International Conference on Multimedia Modeling (MMM2020). Poster<br>[4] Y. Li, Z. Huang, J. Sun. An Efficient Logo Insertion Method for Video Coding in HEVC IEEE 21st International Workshop on Multimedia Signal Processing 27-29 Sept 2019. Oral<br>[5] Zheng Y, Xu P, Sun J, et al. Gradient Based Interpolation for Intra Angular Prediction in HEVC[C]//Circuits and Systems (ISCAS), 2018 IEEE International Symposium on. IEEE, 2018: 1-5.<br>[6] Yushan Zheng ; Peng Xu ; Jun Sun ; Zongming Guo,Gradient Based Interpolation for Intra Angular Prediction in HEVC 2018 IEEE International Symposium on Circuits and Systems<br>[7] Yunchang Li, Qi Jing, Yingfan Zhang, Jun Sun, Efficient Rate Control Method for Logo Insertion Video Coding in HEVC. IEEE International Conference on Visual Communications and Image Processing VCIP December 9-12, 2018, Taichung, Taiwan<br>[8] Keji ChenJun SunZongming Guo,Dachuan Zhao, A Novel Two-Step Integer-pixel Motion Estimation Algorithm for HEVC Encoding on a GPU, , Accepted by MultiMedia Modeling 23rd International Conference(MMM 2017). Oral<br>[9] Wang J, Lei W, Xu P, et al. Adaptive media playout buffer management for latency optimization of mobile live streaming[C]//Multimedia &amp; Expo Workshops (ICMEW), 2017 IEEE International Conference on. IEEE, 2017: 369-374. Oral<br>[10] Jing Q, Xu P, Sun J, et al. Efficient Logo Insertion Method for High-Resolution H. 265/HEVC Compressed Video[C]//Pacific Rim Conference on Multimedia. Springer, Cham, 2017: 674-682.<br>[11] Zhang Y, Lin Z, Feng W, et al. A Real-Time Multi-view AVS2 Decoder on Mobile Phone[C]//Pacific Rim Conference on Multimedia. Springer, Cham, 2017: 89-95.<br>[12] Yinfan Zhang, Zhenan Lin, Weilun Feng, Jun Sun, Zongming Guo, A Real-Time Multi-view AVS2 Decoder on Mobile Phone. Pacific Rim Conference on Multimedia, 2017-5:89-95.<br>[13] Keji Chen, Jun Sun, Yizhou Duan, Zongming Guo, A novel wavefront-based high parallel solution for HEVC encoding, Accepted by IEEE Transactions on Circuits and Systems for Video Technology (TCSVT 2016).<br>[14] Shengbin Meng, Jun Sun, Yizhou Duan, Zongming Guo, Adaptive Video Streaming With Optimized Bitstream Extraction and PID-Based Quality Control, Accepted by IEEE Transactions on Multimedia (TMM 2016).<br>[15] Jiexi Wang, Shengbin Meng, Jun Sun, Zongming Guo, A general PID-based rate adaptation approach for TCP-based live streaming over mobile networks, Accepted by IEEE International Conference on Multimedia and Expo (ICME2016). Oral<br>[16] Zhenan Lin, Qi Zhang, Keji Chen, Jun Sun, Zongming Guo, Efficient Arbitrary Ratio Downscale Transcoding for HEVC, Accepted by IEEE International Conference on Visual Communications and Image Processing (VCIP2016). Oral<br>[17] Peng Xu, Keji Chen, Jun Sun, Xiangyang Ji, Zongming Guo, An Adaptive Intra-Frame Parallel Method based on Complexity Estimation for HEVC, Accepted by IEEE International Conference on Visual Communications and Image Processing (VCIP2016). Oral</p>
<h3 id="before-2015"><a href="#before-2015" class="headerlink" title="before 2015"></a>before 2015</h3><p>[1] Shengbin Meng, Jun Sun , Zongming Guo, Software Solution for HEVC Encoding and Decoding, International Conference on MultiMedia Modeling (MMM), Sydney, Australia, January 5-7, 2015. Demo<br>[2] Jun Sun, Yizhou Duan, Qi Zhang, Jiasi Shen, Zongming Guo , Towards Rate-Distortion Analysis of General Source Distributions: Property and Principles, Accepted by MMSP 2015. Oral<br>[3] Qi Zhang, Yizhou Duan, Jun Sun , Zongming Guo, A Two-Stage Fast CU Size Decision Method for HEVC Intracoding, Accepted by MMSP 2015. Oral<br>[4] Shengbin Meng, Jun Sun, Yizhou Duan, Zongming Guo , An Efficient Method For No-Reference H.264/SVC Bitstream Extraction, IEEE International Conference on Acoustics, Speech, and Signal Processing (ICASSP), Florence, Italy, May 4-9, 2014. Poster<br>[5] Shengbin Meng, Jun Sun , Yilei Wang, Zongming Guo, A PID-based Quality Control Algorithm for SVC Video Streaming, IEEE International Conference on Communications (ICC), Sydney, Australia, June 10-14, 2014. Oral<br>[6] Shengbin Meng, Yizhou Duan, Jun Sun , Zongming Guo, Highly Optimized Implementation of HEVC Decoder for General Processors, IEEE International Workshop on Multimedia Signal Processing (MMSP), Jakarta, Indonesia, September 22-24, 2014. Oral<br>[7] Keji Chen, Yizhou Duan, Jun Sun, Zongming Guo , Towards Efficient Wavefront Parallel Encoding of HEVC: Parallelism Analysis and Improvement, IEEE International Workshop on Multimedia Signal Processing (MMSP), Jakarta, Indonesia, September 22-24, 2014. Oral<br>[8] Yanping Zhou, Yizhou Duan, Jun Sun and Zongming Guo, Proportional Feedback Based Rate Control for Intra Frame of H.164/AVC High Profile, Asia-Pacific Signal and Information Processing Association Annual Summit and Conference (APSIPA), Siem Reap, City of Angkor Wat, Cambodia, December 9-12, 2014. Oral<br>[9] Yanping Zhou, Yizhou Duan, Jun Sun and Zongming Guo, Towards Simple and Smooth Rate Adaption for VBR Video in DASH, Visual Communications and Image Processing (VCIP), Valletta, Malta, December 7-10, 2014. Oral<br>[10] Jun Sun , Yanping Zhou, Yizhou Duan and Zongming Guo, A Low-latency Peer-to-Peer Live and VOD Streaming System Based on Scalable Video Coding, Visual Communications and Image Processing (VCIP), Valletta, Malta, December 7-10, 2014. Demo<br>[11] Yizhou Duan, Jun Sun, Zongming Guo , Rate-quantization and Distortion-quantization Models of Dead-zone Plus Uniform Threshold Scalar Quantizers for Generalized Gaussian Random Variables, 19th International Conference on Mutimedia Modeling(MMM), Huangshan, Anhui, China, January 7-9, 2013.<br>[12] Yizhou Duan, Jun Sun and Zongming Guo, “Rate-distortion analysis and modeling of dead-zone plus uniform threshold scalar quantization for generalized Gaussian random variables,” in Proc. Data Compression Conference (DCC), Snowbird, Utah, USA, Apr. 2012.<br>[13] Yizhou Duan, Jun Sun and Zongming Guo, “Novel rate-distortion modeling for H.264/AVC and its application in two-pass VBR coding,” Accepted by IEEE International Symposium on Circuits and Systems (ISCAS), Seoul, Korea, May. 2012.<br>[14] Wenyao Zhang, Jun Sun, Jiaying Liu and Zongming Guo, “Optimized bit extraction of SVC exploiting linear error model,” Accepted by IEEE International Symposium on Circuits and Systems (ISCAS), Seoul, Korea, May. 2012.<br>[15] Leju Yan, Jun Sun, Yizhou Duan, Zongming Guo, Implementation of HEVC decoder on x86 processors with SIMD optimization, IEEE Visual Communications and Image Processing Conference(VCIP), San Diego, CA, USA, Nov. 27-30, 2012.<br>[16] Leju Yan, Yizhou Duan, Jun Sun and Zongming Guo, “An optimized real-time multi-thread HEVC decoder,” in Proc. IEEE Visual Communication and Image Processing (VCIP), San Diego, USA, Nov. 2012. (Demo)<br>[17] Keji Chen, Yizhou Duan, Leju Yan, Jun Sun and Zongming Gu, Efficient SIMD Optimization of HEVC Encoder over X86 Processors, Asia Pacific Signal and Information Processing Association Annual Summit and Conference(APSIPA), Hollywood, CA, USA, Dec. 3-6, 2012.<br>[18] Yizhou Duan, Jun Sun, Jiaying Liu and Zongming Guo, “Efficient dead-zone plus uniform threshold scalar quantization of generalized Gaussian random variables,” in Proc. IEEE Visual Communication and Image and Processing (VCIP), Tainan, Taiwan, Nov. 2011.<br>[19] Ruiheng Li, Jun Sun and Wen Gao, “Fast Weighted Algorithms for Bitstream Extraction of SVC Medium-Grain Scalable Video Coding”. Proc. IEEE International Conference on Multimedia &amp; Expo (ICME 2010), Singapore, Jun. 2010.<br>[20] Xin Zhao, Jun Sun, Wen Gao, “A Novel Rate Estimation Model for Mode Decision of H.264/AVC,” in Proc. of SPIE Visual Communications and Image Processing (VCIP), San Jose, California USA, Jan. 2009.<br>[21] Zhenyu Wang, Luhong Liang, Xianguo Zhang, Jun Sun, Debin Zhao, Wen Gao, “A Novel Macro-Block Group Scheme of AVS Coding for Many-Core Processor,” in Proceedings of IEEE Pacific-Rim Conference International Conference on Multimedia, PCM2009, Bangkok,Thailand, Dec.2009<br>[22] Jun Sun, Wen Gao, Debin Zhao, “Smooth Extraction of SVC Fine-Granular SNR Scalable Videos with a Virtual-GOP-Based Rate-Distortion Modeling,” in Proc. of SPIE Visual Communications and Image Processing (VCIP), San Jose, California USA, Jan. 2008.<br>[23] Yue Wang, Jun Sun, Siwei Ma, Wen Gao, “Theoretic Analysis of Inter Frame Dependency in Video Coding,” in Proc. of Pacific-Rim Conference on Multimedia (PCM), Dec. 2008.<br>[24] Jun Sun, Wen Gao, Debin Zhao, “Statistical Analysis and Modeling of Rate-Distortion Function in SVC Fine-Granular SNR Scalable Videos,” in Proc. of IEEE International Conference on Multimedia &amp; Expo (ICME), Beijing, China, Jul. 2007.<br>[25] Jun Sun, Wen Gao, Debin Zhao, “Rate-Distortion Modeling and it’s Application to Quality Layer Assignment in SVC Fine-Granular SNR Scalable Videos,” in Proc. of Picture Coding Symposium (PCS), Lisbon, Portugal, Nov. 2007.<br>[26] Jianfei Huang, Jun Sun, Wen Gao, “A Novel Two-Pass VBR Coding Algorithm for the H.264/AVC Video Coder Based on a New Analytical R-D Model,” in Proc. of IEEE Picture Coding Symposium (PCS), Lisbon, Portugal, 2007.<br>[27] Da Liu, Debin Zhao, Jun Sun, Wen Gao, “Direct Mode Coding for B Pictures Using Virtual Reference,” in Proc. of IEEE International Conference on Multimedia &amp; Expo (ICME), Beijing, China, 2007.<br>[28] Jun Sun, Wen Gao, Debin Zhao, Qingming Huang, “A Simple Algorithm for Constant Quality Reconstruction of Scalable Video Using a New Analytical R-D Model,” in Proc. of IEEE Picture Coding Symposium (PCS), Beijing, China, Apr. 2006.<br>[29] Jun Sun, Wen Gao, Debin Zhao, Qingming Huang, “Statistical Model, Analysis and Approximation of Rate-Distortion Function in MPEG-4 FGS Videos,” in Proc. of Visual Communications and Image Processing (VCIP), SPIE Press, Beijing, China, Jul. 2005.<br>[30] Jun Sun, Wen Gao, Qingming Huang, “A Novel FGS Base-Layer Encoding Model And Weight-Based Rate Adaptation for Constant-Quality Streaming,” in Proc. of International Conference on Image and Graphics (ICIG), HongKong, Dec. 2004.</p>

        
      </div>
      
      
      
    </div>
    
    
    
  </div>


          </div>
          


          

  



        </div>
        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" align="center">
<a target="_blank" href="../">中文</a><span>&nbsp&nbsp&nbsp</span><a target="_blank" href="http://www.wict.pku.edu.cn">Wangxuan Institute of Computer Technology</a><span>&nbsp&nbsp&nbsp</span><a target="_blank" href="http://pku.edu.cn">Peking University</a><br>

&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">All Rights Reserved Deep Video Lab | Wangxuan Institute of Computer Technology</span>

  
  <br>Address: No. 128 Zhongguancun North Street, Haidian District, Beijing, 100871, P. R. China
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/en/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/en/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/en/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/en/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/en/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/en/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/en/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/en/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/en/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/en/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/en/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/en/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
